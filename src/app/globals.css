@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* Community Guide Prose Styling - Must come after @plugin to override */
/* Using multiple selectors for maximum specificity */

/* Light mode - darker text on white */
html .prose h1,
html .prose h2,
html .prose h3,
html .prose h4,
html .prose h5,
html .prose h6,
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  color: #0f172a !important; /* slate-900 */
}

html .prose p,
.prose p {
  color: #334155 !important; /* slate-700 */
}

html .prose strong,
.prose strong {
  color: #0f172a !important; /* slate-900 */
}

html .prose li,
.prose li {
  color: #334155 !important; /* slate-700 */
}

/* Dark mode - white/light text on dark */
html.dark .prose h1,
html.dark .prose h2,
html.dark .prose h3,
html.dark .prose h4,
html.dark .prose h5,
html.dark .prose h6,
.dark .prose h1,
.dark .prose h2,
.dark .prose h3,
.dark .prose h4,
.dark .prose h5,
.dark .prose h6 {
  color: #ffffff !important; /* white */
}

html.dark .prose p,
.dark .prose p {
  color: #e5e7eb !important; /* gray-200 */
}

html.dark .prose strong,
.dark .prose strong {
  color: #ffffff !important; /* white */
}

html.dark .prose li,
.dark .prose li {
  color: #e5e7eb !important; /* gray-200 */
}

html {
  scroll-behavior: smooth;
  color-scheme: light dark;
}

/* Define CSS variables for theming */
:root {
  /* Light theme colors - adjusted for better contrast */
  --background: 0 0% 100%;          /* #ffffff white */
  --foreground: 222 47% 11%;        /* #0f172a slate-900 - dark text */
  --card: 0 0% 100%;                /* #ffffff */
  --card-foreground: 222 47% 11%;   /* #0f172a */
  --popover: 0 0% 100%;             /* #ffffff */
  --popover-foreground: 222 47% 11%;/* #0f172a */
  --primary: 199 89% 48%;           /* #0ea5e9 sky-500 */
  --primary-foreground: 0 0% 100%;  /* #ffffff */
  --secondary: 214 32% 95%;         /* #f1f5f9 slate-100 */
  --secondary-foreground: 222 47% 11%;
  --muted: 214 32% 95%;             /* #f1f5f9 slate-100 */
  --muted-foreground: 215 20% 35%;  /* Darker for readability - was 47% */
  --accent: 214 32% 95%;            /* #f1f5f9 */
  --accent-foreground: 222 47% 11%;
  --destructive: 0 84% 60%;         /* #ef4444 red-500 */
  --destructive-foreground: 0 0% 100%;
  --success: 142 71% 45%;           /* #10b981 emerald-500 */
  --success-foreground: 0 0% 100%;
  --border: 214 32% 91%;            /* #e2e8f0 slate-200 */
  --input: 214 32% 91%;             /* #e2e8f0 */
  --ring: 199 89% 48%;              /* #0ea5e9 */

  /* Contributor icon gradients */
  --gradient-icon-code: linear-gradient(135deg, #34d399 0%, #06b6d4 100%);
  --gradient-icon-donate: linear-gradient(135deg, #38bdf8 0%, #6366f1 100%);
  --gradient-icon-sponsor: linear-gradient(135deg, #fde047 0%, #f97316 100%);
  --gradient-icon-member: linear-gradient(135deg, #fb923c 0%, #ef4444 100%);
}

.dark {
  /* Dark theme colors - slate-900 base */
  --background: 222 47% 11%;        /* #0f172a slate-900 */
  --foreground: 0 0% 100%;          /* #ffffff pure white - brighter */
  --card: 217 33% 17%;              /* #1e293b slate-800 */
  --card-foreground: 210 40% 98%;
  --popover: 217 33% 17%;           /* #1e293b */
  --popover-foreground: 210 40% 98%;
  --primary: 199 89% 48%;           /* #0ea5e9 sky-500 */
  --primary-foreground: 0 0% 100%;
  --secondary: 215 25% 27%;         /* #334155 slate-700 */
  --secondary-foreground: 210 40% 98%;
  --muted: 217 33% 17%;             /* #1e293b slate-800 */
  --muted-foreground: 215 20% 65%;  /* #94a3b8 slate-400 */
  --accent: 215 25% 27%;            /* #334155 slate-700 */
  --accent-foreground: 210 40% 98%;
  --destructive: 0 84% 60%;         /* #ef4444 */
  --destructive-foreground: 0 0% 100%;
  --success: 142 71% 45%;           /* #10b981 emerald-500 */
  --success-foreground: 0 0% 100%;
  --border: 215 25% 27%;            /* #334155 slate-700 - subtle border */
  --input: 215 25% 27%;
  --ring: 199 89% 48%;

  /* Contributor icon gradients (brighter for dark mode) */
  --gradient-icon-code: linear-gradient(135deg, #34d399 0%, #22d3ee 100%);
  --gradient-icon-donate: linear-gradient(135deg, #38bdf8 0%, #818cf8 100%);
  --gradient-icon-sponsor: linear-gradient(135deg, #fde047 0%, #fb923c 100%);
  --gradient-icon-member: linear-gradient(135deg, #fb923c 0%, #f87171 100%);
}

/* Tailwind theme configuration */
@theme {
  /* Semantic colors using HSL space for opacity support */
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-success: hsl(var(--success));
  --color-success-foreground: hsl(var(--success-foreground));
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
}

body {
  min-height: 100vh;
  background:
    linear-gradient(
      135deg,
      hsl(var(--background)) 0%,
      hsl(var(--primary) / 0.03) 50%,
      hsl(var(--background)) 100%
    );
  background-size: 200% 200%;
  animation: subtleGradientShift 20s ease-in-out infinite;
  color: hsl(var(--foreground));
  font-family: var(--font-geist-sans), -apple-system, BlinkMacSystemFont, "Segoe UI",
    sans-serif;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  transition: color 0.3s ease-in-out;
}

button {
  cursor: pointer;
}

@media (prefers-reduced-motion: reduce) {
  body {
    animation: none;
    background: hsl(var(--background));
  }
}

*, *::before, *::after {
  box-sizing: border-box;
}

/* Smooth theme transitions - only for theme-related properties on specific elements */
/* DO NOT use * selector - breaks animations and performance */
:where(button, a, input, select, textarea, [class*="bg-"], [class*="text-"], [class*="border-"]) {
  transition-property: background-color, color, border-color, box-shadow, fill, stroke;
  transition-duration: 0.3s;
  transition-timing-function: ease-in-out;
}

/* Enhanced transitions for interactive elements */
:where(button, a, input, select, textarea) {
  transition-property: background-color, color, border-color, box-shadow, transform, fill, stroke;
  transition-duration: 0.3s, 0.3s, 0.3s, 0.3s, 0.2s, 0.3s, 0.3s;
  transition-timing-function: ease-in-out;
}

/* Prevent transitions on page load */
.no-transition,
.no-transition * {
  transition: none !important;
}

/* Base link styles */
a {
  text-decoration: none;
}

/* Only inherit color for non-button links */
a:not(.inline-flex) {
  color: inherit;
}

/* Force button links to respect their own color classes */
a.inline-flex {
  color: currentColor;
}

.chat-scroll {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.chat-scroll::-webkit-scrollbar {
  width: 0;
  height: 0;
}

.chat-scroll:hover {
  scrollbar-width: thin;
}

.chat-scroll:hover::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.chat-scroll:hover::-webkit-scrollbar-thumb {
  background-color: rgba(148, 163, 184, 0.5);
  border-radius: 9999px;
}

/* Semantic Gradient Backgrounds */
.bg-gradient-accent {
  background: linear-gradient(135deg,
    hsl(var(--primary) / 0.1) 0%,
    hsl(var(--accent) / 0.15) 50%,
    hsl(var(--secondary) / 0.1) 100%);
}

.bg-gradient-accent-secondary {
  background: linear-gradient(135deg,
    hsl(var(--primary) / 0.15) 0%,
    hsl(var(--ring) / 0.2) 50%,
    hsl(var(--accent) / 0.15) 100%);
}

.bg-gradient-accent-tertiary {
  background: linear-gradient(135deg,
    hsl(var(--secondary) / 0.1) 0%,
    hsl(var(--muted) / 0.2) 50%,
    hsl(var(--accent) / 0.1) 100%);
}

.bg-gradient-vibrant {
  background: linear-gradient(135deg,
    hsl(var(--primary) / 0.2) 0%,
    hsl(var(--ring) / 0.25) 50%,
    hsl(var(--accent) / 0.2) 100%);
}

.bg-gradient-subtle {
  background: linear-gradient(135deg,
    hsl(var(--muted) / 0.3) 0%,
    hsl(var(--accent) / 0.4) 50%,
    hsl(var(--secondary) / 0.3) 100%);
}

@keyframes mascot-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes coin-flip {
  0% {
    transform: rotateY(0deg);
  }
  50% {
    transform: rotateY(180deg);
  }
  100% {
    transform: rotateY(360deg);
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  50% {
    opacity: 0.85;
    transform: translate(-50%, -50%) scale(1.05);
  }
}

@keyframes subtleGradientShift {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

@keyframes slide-in-from-right-full {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

/* Leaflet Map Styles */
.leaflet-popup-content-wrapper {
  background-color: hsl(var(--card)) !important;
  color: hsl(var(--card-foreground)) !important;
  border: 2px solid hsl(var(--border)) !important;
  border-radius: 0.75rem !important;
  padding: 0 !important;
  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1) !important;
}

.leaflet-popup-tip {
  background-color: hsl(var(--card)) !important;
  border: 2px solid hsl(var(--border));
}

.leaflet-popup-content {
  margin: 0 !important;
  min-width: 320px !important;
  max-width: 400px !important;
  width: auto !important;
  color: hsl(var(--card-foreground)) !important;
  overflow: visible !important;
}

.leaflet-popup-content * {
  color: inherit;
}

/* Ensure popups don't get too close to edges */
.leaflet-popup {
  margin-bottom: 20px !important;
}

.custom-marker {
  background: transparent;
  border: none;
}

.custom-marker-icon {
  background: transparent !important;
  border: none !important;
}

.custom-marker-icon svg {
  filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
  transition: transform 0.2s ease;
}

.custom-marker-icon:hover svg {
  transform: scale(1.15);
}

/* Hide default Leaflet close button since we removed it */
.leaflet-container a.leaflet-popup-close-button {
  display: none !important;
}

/* Custom popup styling */
.leaflet-popup {
  margin-bottom: 20px !important;
}

.leaflet-popup-content-wrapper {
  padding: 0 !important;
}

/* Shimmer animation for chat loading text */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}
